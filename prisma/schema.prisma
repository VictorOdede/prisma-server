datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

enum Role {
    USER
    PAYER
    ADMIN
}

model Owner {
    id                Int           @id @default(autoincrement())
    sacco             String        @unique
    email             String        @unique
    vehicles          Vehicle[]
    businessShortcode Int           @unique
    role              Role          @default(USER)
    transaction       Transaction[]
}

model Payer {
    id           Int           @id @default(autoincrement())
    createdAt    DateTime      @default(now())
    phone        String        @unique
    role         Role          @default(PAYER)
    transactions Transaction[]
}

model Vehicle {
    id           String        @id @default(uuid())
    registration String        @unique
    passengers   Int
    phone        String        @unique
    myOwner      Owner         @relation(fields: [ownerSacco], references: [sacco])
    ownerSacco   String
    transactions Transaction[]
}

model Transaction {
    id              Int      @id @default(autoincrement())
    amount          Int
    createdAt       DateTime @default(now())
    updatedAt       DateTime @updatedAt
    mpesaId         String?  @unique
    sender          Payer    @relation(fields: [senderNumber], references: [phone])
    senderNumber    String
    recepient       Vehicle  @relation(fields: [recepientNumber], references: [phone])
    recepientNumber String
    mySacco         Owner    @relation(fields: [paybill], references: [businessShortcode])
    paybill         Int
    success         Boolean  @default(false)

}
