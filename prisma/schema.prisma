datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
}

enum Role {
    OWNER
    ADMIN
}

model Owner {
    id                Int           @id @default(autoincrement())
    sacco             String        @unique
    email             String        @unique
    vehicles          Vehicle[]
    businessShortcode String        @unique
    role              Role          @default(OWNER)
    transaction       Transaction[]
}

model Payer {
    id           Int           @id @default(autoincrement())
    createdAt    DateTime      @default(now())
    phone        String        @unique
    transactions Transaction[]
}

model Vehicle {
    id           String        @id @default(uuid())
    registration String        @unique
    passengers   Int
    phone        String        @unique
    myOwner      Owner         @relation(fields: [ownerSacco], references: [businessShortcode])
    ownerSacco   String
    transactions Transaction[]
}

model Transaction {
    id             Int      @id @default(autoincrement())
    amount         Int
    createdAt      DateTime @default(now())
    updatedAt      DateTime @updatedAt
    sender         Payer    @relation(fields: [senderNumber], references: [phone])
    senderNumber   String
    recepient      Vehicle  @relation(fields: [recepientPlate], references: [registration])
    recepientPlate String
    success        Boolean  @default(false)
    Owner          Owner?   @relation(fields: [ownerId], references: [id])
    ownerId        Int?
}
